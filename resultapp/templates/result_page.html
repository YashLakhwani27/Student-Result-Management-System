{% extends "base.html" %}

{% block content %}


<div class="container py-5" id="content">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow">
                <div class="card-header text-center bg-dark text-white">
                    <h4><i class="fas fa-graduation-cap me-2"></i>Student Result Details</h4>
                </div>
                <div class="card-body">
                     {% if messages %}
    {% for m in messages %}
    
    <div class=" text-center mt-5 alert alert-{% if m.tags == 'error' %}danger{% else %}{{m.tags}} {% endif %} alert-dismissable fade show" role="alert">
        {{m}}
        <button class="btn-close" type="button" data-bs-dismiss="alert"></button>
    </div>

    {% endfor %}
    {% endif %}
                    <p><strong>Roll Id: </strong>{{student.roll_id}}</p>
                    <p><strong>Full Name: </strong>{{student.name}}</p>
                    <p><strong>Class: </strong>{{student.student_class.class_name}} - {{student.student_class.section}} </p>


                    {% if results %}
                    <table class="table table-bordered mt-5 table-striped text-center"> 

                        <thead>

                            <tr>
                                <th>#</th>
                                <th>Subject</th>
                                <th>Marks</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for r in results %}
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{r.subject.subject_name}}</td>
                                <td>{{r.marks}}</td>
                            </tr>
                            {% endfor %}
                        </tbody>

                        <tr>
                            <th colspan="2">Total Marks</th>
                            <td><b>{{total_marks}}</b> out of <b>{{max_total}}</b></td>
                        </tr>
                        <tr>
                            <th colspan="2">Percentage</th>
                            <td><b>{{percentage}}%</b></td>
                        </tr>

                        <td colspan="3">
                            <i class="fas fa-print fa-2x" style="cursor: pointer;" onclick="printResult()"></i>
                        </td>
                    </table>
                    {% else %}
                    <div class="alert alert-warning">Your result is not declared yet</div>
                    {% endif %}

                </div>
            </div>
        </div>

    </div>

</div>


<script>
    function printResult(){

        let content = document.getElementById('content').innerHTML
        let win = window.open("","",height="700",width="900")
        
        win.document.write("<html><head><title>Print Result</title>");
        win.document.write('<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">')
        win.document.write('<style>@media print {body {-webkit-print-color-adjust: exact;}}</style>');
        win.document.write("</head><body>");
            win.document.write(content);
            win.document.write("</body></html>");
            win.document.close()
            win.document.print()
        }


</script>
{% endblock %}